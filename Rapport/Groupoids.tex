\section{Preliminaries on topological groupoids}

\begin{definition}
A topological groupoid is the data of 
\begin{itemize}
\item[$\bullet$] two topological spaces $G$ and $G^{(0)}$, called respectively the space of arrows, and the unit space,
\item[$\bullet$] a topological embedding $e: G^{(0)}\rightarrow G; x\mapsto e_x$ called the unit map,
\item[$\bullet$] source and range maps $r,s : G\rightarrow G^{(0)}$ which are continuous, surjective, and satisfy $r\circ e = s\circ e = Id_{G^{(0)}}$,
\item[$\bullet$] a continuous multiplication map $m : G^{(2)}=G\times_{s,r}G\rightarrow G; (g,g')\mapsto gg'$ such that $(gg')g''=g(g'g'')$ for all triple $g,g',g''$ that are composable,
\item[$\bullet$] an inverse map $\text{inv} : G\rightarrow G: g\mapsto g^{-1}$ which is continous and such that $\forall g\in G, gg^{-1}=e_{s(g)} \text{ and }g^{-1}g=e_{r(g)}$, and $g e_{s(g)} = e_{r(g)} g =g$.
\end{itemize} 
\end{definition}

\begin{definition}
Let $G$ be a locally compact groupoid, i.e. a topological groupoid locally compact as a topological space.\\
$G$ is said to be étale if the range map $r:G\rightarrow G^{(0)}$ is a local homeomorphism.\\
$G$ is said to be principal if $r\times s : G\rightarrow G^{(0)}\times G^{(0)}$ is injective, transitive if $r\times s $ is surjective, and proper if $r\times s $ is a proper map. 
\end{definition}

If $G$ is étale, then any $g\in G$ has an open neighborhood $U$ such that $r$ and $s$ are injective on $U$. The element $g$ defines in this way a partial homeomorphism $\alpha_U = r\circ (s_{|U})^{-1} : s(U)\rightarrow r(U)$. Such open sets $U$ where $r$ and $s$ are injective are called bisections. The set of bisections is naturally an inverse semi-group. \cite{paterson}\\

For $U,V\subset G^{(0)}$, we will us the notations $G_U=s^{-1}(U)$, $G^V=r^{-1}(V)$ and $G_U^V=s^{-1}(U)\cap r^{-1}(V)$. If one of the subsets is reduced to a single point, we will use $G_x=G_{\{x\}}$, etc. We will write $G_{|U}$ for $G_U^U$. It is a subgroupoid of $G$.\\

A Haar system on $G$ is a family of borelian measures $(\lambda^x)_{x\in G^{(0)}}$ such that 
\begin{itemize}
\item[$\bullet$] the support of $\lambda^x$ is $G^x$, 
\item[$\bullet$] the map $G^{(0)} \rightarrow \C; x\mapsto \int_{G^x} f d\lambda^x$ is continuous for all $f\in C_c(G)$,
\item[$\bullet$] for all $f\in C_c(G)$ and $g\in G$, $\int_{G^{r(g)}} f(h) d\lambda^{r(g)}(dh)= \int_{G^{s(g)}} f(gh) \lambda^{s(g)}(dh)$ holds.
\end{itemize}

Here are classical examples of groupoids.\\

\begin{Expl}[Groups and spaces] Any group $G$ is a groupoid over a point $G^{(0)}=*$. $G$ is étale as a groupoid if it is a discrete group. A topological space is also a groupoid over itself, the only arrows being the units over the points : $G^{(0)} = X = G$, $s=r=id_X$, it is always étale.
\end{Expl}

\begin{Expl}[Pair groupoid] Let $X$ be a set, and consider $G=X\times X$ with base space $G^{(0)}=X$ and projection maps as traget and source $s=pr_1, r=pr_2$. Composition is given by $(x,y)(y,z)= (x,z)$, and one can easily check that $e_x=(x,x)$ and $(x,y)^{-1} = (y,x)$. $X\times X$ is étale if $X$ is discrete.
\end{Expl}

\begin{Expl}[Equivalence relations and pull-back] More generally, consider an equivalence relation $R \subset X\times X$ on a topological space $X$. It naturally has a structure of topological groupoid, as a subgroupoid of $X\times X$. Consider a cover $\mathcal U$ of $G^{(0)}$ by open subsets, and let $p : \sqcup G_{|U} \rightarrow G$ be the natural projection. We define $G[\mathcal U]$ the topological groupoid obtained as the groupoid of the equivalence relation defined by $g\sim g'$ if and only if $p(g)=p(g')$. It is convient to represent this groupoid as the set of triples $(U,g,V)$ such that $s(g)\in U$ and $r(g)\in V$
\end{Expl}

\begin{Expl}[Principal groupoid of a group action] Let $G$ be a group acting on a topological space $X$ by homeomorphisms. Define the groupoid $X\rtimes G$ as the topological space $X\times G$ over the base space $X$, endowed with the maps $s(x,g)=x$ and $r(x,g)=g.x$. The unit map will be given by $x\mapsto (x,e_G)$ and $(x,g)^{-1} = (g.x , g^{-1})$. This groupoid is called the principal action groupoid. It is étale when $G$ is a discrete group.  
\end{Expl}

These examples show how the notion of topological groupoid interpolates between a group and a space. However, other examples of interesting groupoids abound in analysis and geometry. For example, we will define later a so called Coarse Groupoid associated to any Coarse Space, after \cite{SkTuYu}, whose importance cannot be stressed enough to our approach to the Coarse Baum-Connes conjecture.\\

Other examples includes the holonomy groupoid of a foliation \cite{connesfoliations}, Lie groupoids \cite{paterson}, etc. One of the reasons groupoids are such famous objects in noncommutative geometry is that we can still do analysis on it. According to the general philosophy of Connes \cite{Connes94}, groupoids encode geometric situations and remain available to analysis, even when the situation is so pathological that classical tools become trivial. For example, when confronted to a group action, considering the convolution algebra of the principal action groupoid can be a substitute to the studying the quotient space. It turns out that, when the action is free and proper, the envelopping $C^*$-algebra is Morita equivalent to $C_0(X/G)$, which represent the quotient space by Gelfand duality. However, when the quotient is badly behaved, the envelopping $C^*$-algebra still carries usefull information, even if the quotient  is such that $C_0(X/G) = \C$.

\subsection{Actions of groupoids}

\begin{definition}
A left action of $G$ on a topological space $Z$ is given by a continuous map $p : Z \rightarrow G^{(0)}$, called the anchor map, and a map $\alpha : G\times_{s,p} Z \rightarrow Z $ such that :
\begin{itemize}
\item[$\bullet$] $\alpha(g',\alpha(g,z)) = \alpha(g'g,z)$ whenever $(g,g')\in G^{(2)}$ and $p(z)=s(g)$,
\item[$\bullet$] $p(\alpha(g,z))= r(g)$
\item[$\bullet$] $\alpha(e_{p(z)},z)=z$
\end{itemize} 
We will use the notation $\alpha(g,z) = g.z$ when the action is clear from the context, and $Z$ will then be referred as a (left) $G$-space.\\

An right action of $G$ on a topological space $Z$ is given by a continuous map $p : Z \rightarrow G^{(0)}$, again called the anchor map, and a map $\alpha : Z\times_{p,r} G \rightarrow Z $ such that :
\begin{itemize}
\item[$\bullet$] $\alpha(\alpha(z,g),g') = \alpha(z, gg')$ whenever $(g,g')\in G^{(2)}$ and $p(z)=r(g)$,
\item[$\bullet$] $p(\alpha(z,g))= s(g)$
\item[$\bullet$] $\alpha(z,e_{p(z)})=z$
\end{itemize} We will use the notation $\alpha(g,z) = z.g$ when the action is clear from the context.\\ 
\end{definition}

A left action $(Z,p,\alpha)$ is said to be 
\begin{itemize}
\item[$\bullet$] proper if $id_Z \times \alpha : (g,z) \mapsto (z,g.z) $ is proper as a continous map,
\item[$\bullet$] free if $\alpha(g,z)=z \Rightarrow g=e_{p(z)} $.
\end{itemize}
Similarly, we define these notions for right actions.\\

Let $Z$ be a right $G$-space. Define :
\begin{itemize}
\item[$\bullet$] $(Z\rtimes G)^{(0)} = Z$, $Z\rtimes G = Z\times_{r,p} G$ as a topological space,
\item[$\bullet$] $u_{z}= (z,e_{p(z)})$, $ s(z,g) = z$ and $r(z,g)=z.g$, 
\item[$\bullet$] if $y = x.g$, $(x,g)(y,g')= (x,gg') $ and $(x,g)^{-1} = (x.g,g^{-1})$.
\end{itemize}

These maps define a structure of toplogical groupoid on $Z\rtimes G$. It is called the crossed product groupoid of $Z$ by $G$. It is étale if $G$ is.\\

\subsection{$G$-algebras}

\begin{definition}
Let $X$ be a topological space. A $C(X)$-algebra is a $C^*$-algebra together with a $*$-homomorphism $\theta : C_0(X)\rightarrow Z(\mathcal M(A))$ such that $\overline{\theta (C_0(X)) A} = A$. The couple $(A,\theta)$ is then called a $C(X)$-structure.
\end{definition} 

If $f : X\rightarrow Y$ is a continuous map between locally compact spaces, and $A$ a $Y$-algebra, then $f$ induces a $C(X)$-structure on $A$ by $f^* : C(Y) \rightarrow C_b(X); g\mapsto g\circ f$. Define $f^* A = A \otimes_{f^*} C_0(X)$ the resulting $C(X)$-algebra. For details on tensor products of $C(X)$-algebras, see \cite{LeGall} for instance. As a particular case, one gets the notion of a fiber of a $C(X)$-algebra : for $x\in X$, $A_x = ev_x^* \ A$ is called the fiber over $x$, where $ev_x$ is the inclusion of $x$ in $X$. It is convenient to see $A_x$ as $A/ (I_x .A)$ where $I_x$ is the ideal ker $(ev_x : C_0(X) \rightarrow \C)$.\\

A $*$-homomorphism between two $C(X)$-algebras $\alpha : A\rightarrow A'$ is a $*$-homomorphism which commutes with the action of $C_0(X)$, i.e. $\alpha(\theta(f)a)=\theta'(f)\alpha(a)$ for all $a\in A,f\in C_0(X)$. Its fibers are defined unambiguously by $\alpha_x = id_\C \otimes_{ev_x} \alpha$.\\ 

\begin{definition}
An action of a groupoid $G$ on a $C^*$-algebra $A$ is a triple $(A,\theta,\alpha)$ where $(A,\theta)$ is a $C(G^{(0)})$-structure and $\alpha : s^* A \rightarrow r^* A$ is an isomorphism of $C(G^{(0)})$-algebras such that $\alpha_{gg'}= \alpha_g\circ \alpha_{g'}$ for all $(g,g')\in G^{(2)}$.
\end{definition} 

\subsection{Crossed products}

If $A$ is a $G$-algebra, and $U \subset G^{(0)}$ is an open subset, recall \cite{LeGall} that the restriction $A_U$ is defined as $\eta^* A = C_0(U) \otimes_\eta A$ where $\eta : C(U) \hookrightarrow C_0(G^{(0)})$ is the canonical inclusion. Let $F= G^{(0)}\backslash U$. As $A_U$ is naturally embedded into $A$, define $A_F$ to be the complementary of $A_U$. \\

Let $E$ be a compact subset of $G$. The space of continuous sections with support in $E$ is defined as $A_E$. Then 
\[C_c(G,A) = \cup_{E\in \mathcal E} A_E\]
is called the space of continuous sections with compact support. It is naturally a $*$-algebra with the convolution product
\[\phi\ast \psi (g) = \int_{G^{r(g)}} \phi(h)\psi(h^{-1}g)\lambda^{r(g)}(h).\] 

If $f\in C_c(G,A)$, define $\lambda(f)\in \mathcal L(L^2(G,A))$ as the convolution operator 
\[\lambda(f)\eta = f\ast \eta\]
and the reduced norm as $||f||_r= ||\lambda(f)||_{\mathcal L(L^2(G,A))}$.
\begin{definition}
The reduced crosssed product $A\rtimes_r G$ is defined as the completion of $C_c(G,A)$ under the reduced norm.
\end{definition}

\subsection{Equivariant $KK$-theory}

In \cite{LeGall}, Le Gall defined, for any locally compact groupoid $G$, and $G$-algebras $A$ and $B$, $\Z_2$-graded abelian groups $KK^G(A,B)$ generalizing Kasparov's equivariant $KK$-theory for a locally compact group. Elements of $KK^G(A,B)$ are defined as equivalence classes of triples $(E,\pi,T)$ that we will call $K$-cycles, where :
\begin{itemize}
\item[$\bullet$] $E$ is a right $\Z_2$-graded $B$-Hilbert module, equipped with a unitary action of $G$, i.e. an even unitary $V\in\mathcal L_B(s^*E,r^*E)$ such that $V_g V_{g'} = V_{gg'}$ for all $(g,g')\in G^{(2)}$,
\item[$\bullet$] $\pi : A\rightarrow \mathcal L_B(E)$ is a $*$-homomorphism with image containe in even operators, and we will often write $a$ instead of $\pi(a)$,
\item[$\bullet$] $T\in\mathcal L_B(E)$ is an odd bounded $B$-linear operator satifying the $K$-cycle relations i.e. $[a, T]$, $a(T-T^*)$, $a(T^2-1)$ are compact operators in $\mathfrak K_B(E)$ and $a(r^* T -V s^*T V^*)$ is a compact operator in $\mathfrak K_{r^* B}(r^* E)$ for all $a\in A$.
\end{itemize} 

The set of such $K$-cycles is denoted by $\mathbb E^G(A,B)$.

\begin{definition}
Two $K$-cycles $(E,\pi,T)$ and $ (E',\pi',T')$ in $\mathbb E^G(A,B)$ are homotopic if there exists $ (\tilde E,\tilde \pi,\tilde T) \in\mathbb E^G(A,B[0,1])$ such that $(\tilde E_0,\tilde \pi_0,\tilde T_0)\simeq (E,\pi,T)$ and $(\tilde E_1,\tilde \pi_1,\tilde T_1)\simeq (E',\pi',T')$.
\end{definition}

We will use the following result.\cite{blackadar}\cite{CuSk}

%\begin{prop}
%Let $z\in KK^G_1(A,B)$. The induced homomorphism $-\otimes_A z : K_*(A)\rightarrow K_*(B)$ can be realized, up to Morita equivalence, as the boundary of the following semi-split $G$-equivariant extension of $G$-algebras
%\[\begin{tikzcd}[column sep = small] 
%0 \arrow{r}& \mathfrak K \otimes B \arrow{r} & E^{\pi,T} \arrow{r} & A \arrow{r} & 0\end{tikzcd}\]
%where $E^{\pi,T}=\{(a,P\pi(a)P +y) : a\in A , y\in \mathfrak K \otimes B\}$, the arrows are the obvious inclusion and projection, and the completely positive section is $a\mapsto (a, P \pi(a) P)$. Here, we implicitely choose a $K$-cycle $(H_B,\pi,T)$ representing $z$, and $P=\frac{1+T}{2}$. The fact that this choice does not affect the boundary will be proven in the upcoming sections. 
%\end{prop}

\begin{prop}
Let $z\in KK^G_1(A,B)$ and choose any $K$-cycle $(H_B,\pi,T)$ representing $z$. Let $P=\frac{1+T}{2}$. The induced homomorphism 
\[-\otimes_A z : K_*(A)\rightarrow K_*(B)\]
can be realized, up to Morita equivalence, as the boundary of the following semi-split $G$-equivariant extension of $G$-algebras
\[\begin{tikzcd}[column sep = small] 
0 \arrow{r}& \mathfrak K \otimes B \arrow{r} & E^{\pi,T} \arrow{r} & A \arrow{r} & 0\end{tikzcd}\]
where $E^{\pi,T}=\{(a,P\pi(a)P +y) : a\in A , y\in \mathfrak K \otimes B\}$, the arrows are the obvious inclusion and projection, and the completely positive section is $a\mapsto (a, P \pi(a) P)$. The fact that the choice of the representent does not affect the boundary will be proven in the upcoming sections. 
\end{prop}

The following result will be constantly used in the upcoming sections. In short, it explains how to construct the boundary map associated to any extension $0\rightarrow J\rightarrow A \rightarrow A/J \rightarrow 0$ as the Kasparov product of an element $[\partial_{J,A}]\in KK^G_1(A/J,J)$. For references, see \cite{blackadar}.\\

Recall that, for any $G$-equivariant $*$-homomorphism $\phi : A \rightarrow B$, we can define its cone denoted $C_\phi$ by 
\[C_\phi = \{(a,f)\in A\times CB \text{ s.t. } \phi(a)=f(0)\}.\]
If any $G$-algebra $A$ is given, $0\rightarrow SA\rightarrow CA\rightarrow A \rightarrow 0$ is a $G$-equivariant semi-split extension, and defines an element $[\partial_A]=\tau_A([\partial_\C])\in KK^G_1(A,SA)$ which is invertible. Now, give yourself a semi-split extension 
\[\begin{tikzcd}[column sep = small]0 \arrow{r} & J \arrow{r}{\iota} & A \arrow{r}{q} & A/J \arrow{r}& 0 \end{tikzcd}\] 
and define $\alpha : J\rightarrow C_q ; x\mapsto (x,0)$ and the canonical inclusion $\beta : S (A/J)\hookrightarrow C_q$. It turns out that $[\alpha]\in KK_0^G(J,C_q)$ is invertible.

\begin{prop}
The boundary map $\partial_{J,A} : K_*(A/J)\rightarrow K_{*+1}(J)$ is given by the Kasparov product by an element $[\partial_{J,A}]\in KK^G_1(J,A/J)$ which satisfies 
\[[\partial_{J,A}] = [\partial_{A/J}]\otimes_{} \beta^*([\alpha]^{-1}).\]
\end{prop}

The next lemma will be used during the proof of the functorial properties of the controlled Roe and Kasparov tranformations that will be defined later. These transformations are defined on $K$-cycle which are put in standard form, i.e. $[H_B,\pi,T]$, but changing the coefficients leads to $K$-cycles which are not of this form, hence the lemma. It states that we can always describe explicitely the standard form of a $K$-cycle pushed forward.

\begin{lem}\label{isometryKK}
Let $\phi : B\rightarrow B'$ be a $G$-equivariant homomorphism, and $z=[H_B,\pi, T]\in KK^G(A,B)$. Let $V\in\mathcal L_{B'}(H_B\otimes B', H_{B'})$ be the isometry of the remark \ref{isometry} and $p = VV^*\in\mathcal L_{B'}(H_{B'})$. Define $\pi' : A\rightarrow \mathcal L_{B'}(H_{B'})$ as $\pi'(a) = V\pi(a)V^*$ and $T'= V(T\otimes_\phi 1)V^* + 1-p \in \mathcal L_{B'}(H_B')$. Then $(H_{B'},\pi',T')$ is a $K$-cycle and 
\[g^*(z) = [H_B\otimes B',\pi\otimes_\phi 1,\phi_*(T)]=[H_B', \pi', T']\text{ in } KK^G(A,B').\]
\end{lem} 

\begin{dem}
As a simple computation shows : 
\[\begin{array}{ll} [\pi'(a),T'] = V[\pi(a),T]V^*, &  T'^*-T' = V(T^*\otimes_\phi 1-T\otimes_\phi 1)V^* \\
 T'^2-T' = V(T^2\otimes_\phi 1-T\otimes_\phi 1)V^* & \text{and } r^* T' - U s^*T' U^* = V((r^*(T) - U s^*(T) U^*)\otimes_\phi 1 ) V^*
\end{array} \]
(where $U$ is the action of $G$ on $E$). Hence $[H_{B'},\pi',T']$ satisfies the relations of $K$-cycle.\\

Remark \ref{isometry} shows that $ (H_B\otimes_\phi B' )\oplus (1-p) H_{B'} \cong H_{B'}$.\\

Put $E= H_{B'} \oplus (H_B\otimes_\phi B')$ and $R_s =\begin{pmatrix} \cos (s) id_{H_{B'}} & -\sin (s) V \\  \sin (s)V^* & \cos (s) V^*V \end{pmatrix}$ , and define
\[\begin{array}{c} 
T_s = R_s\begin{pmatrix} V(T\otimes_\phi 1)V^* +1-VV^* & 0 \\ 0 & -T\otimes_\phi 1 \end{pmatrix}R_s^*,\\
\pi_s(a)= \begin{pmatrix} V(\pi(a)\otimes_\phi 1) V^* & 0 \\ 0 & \pi(a)\otimes_\phi 1\end{pmatrix}
\end{array}.\]
Then $ s\mapsto [E, \pi_s,T_s ] $ is an homotopy from $[H_{B'}, \pi', T']-[H_B\otimes B',\pi\otimes_\phi 1,\phi_*(T)]$ to the cycle given by 
\[\begin{pmatrix} V(T\otimes_\phi 1)V^*  & 0 \\ 0 & -T\otimes_\phi 1 \end{pmatrix}\]
which is $0\in KK^G(A,B)$. \\
\qed\end{dem}






































